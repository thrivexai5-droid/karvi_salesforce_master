{% extends 'dashboard/base.html' %}

{% block content %}
<div class="container-fluid p-0 m-0" style="width: 100%; max-width: none;"></div>
    <div class="dashboard-layout">
        <!-- Chart 1 - Top Left -->
        <div class="chart-container shadow-sm">
            <h6 class="chart-title">Sales Distribution</h6>
            <div class="chart-wrapper">
                <div id="apexChart1"></div>
            </div>
        </div>

        <!-- Chart 2 - Top Center -->
        <div class="chart-container shadow-sm">
            <h6 class="chart-title">User Demographics</h6>
            <div class="chart-wrapper">
                <div id="apexChart2"></div>
            </div>
        </div>

        <!-- Value Cards - Top Right (Split into two cards) -->
        <div class="value-cards-container">
            <!-- Total Value Card -->
            <div class="card stats-card small-card shadow-sm border-0">
                <div class="card-body text-center d-flex flex-column justify-content-center">
                    <div class="card-icon mx-auto mb-2">
                        <i class="bi bi-currency-rupee"></i>
                    </div>
                    <div class="card-content">
                        <h6 class="card-subtitle text-muted text-uppercase small fw-bold mb-1">Total Value</h6>
                        <h3 class="card-value fw-bold mb-1">4,21,50,000</h3>
                    </div>
                </div>
            </div>
            
            <!-- GST Value Card -->
            <div class="card stats-card small-card shadow-sm border-0">
                <div class="card-body text-center d-flex flex-column justify-content-center">
                    <div class="card-icon mx-auto mb-2">
                        <i class="bi bi-graph-up"></i>
                    </div>
                    <div class="card-content">
                        <h6 class="card-subtitle text-muted text-uppercase small fw-bold mb-1">GST Value</h6>
                        <h3 class="card-value fw-bold mb-1">78,94,560</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart 3 - Bottom Left -->
        <div class="chart-container shadow-sm">
            <h6 class="chart-title">Leads chart</h6>
            <div class="chart-wrapper">
                <div id="apexChart3"></div>
            </div>
        </div>

        <!-- Empty Space - Bottom Center -->
        <div class="empty-space"></div>

        <!-- Large Card - Bottom Right -->
        <div class="card stats-card large-card shadow-sm border-0">
            <div class="card-body">
                <h6 class="card-title fw-bold mb-4">Task pandeing</h6>
                <h5 class="mb-3"></h5>
                <div class="stats-grid">
                    <div class="activity-item mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Purchase Order</strong> 
                            </div>
                            <div class="text-muted small">Delivered</div>
                        </div>
                    </div>
                    <div class="activity-item mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Inquire</strong> 
                            </div>
                            <div class="text-muted small">Status Pending</div>
                        </div>
                    </div>
                    <div class="activity-item mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Quotation</strong> â€” Sent
                            </div>
                            <div class="text-muted small">Delivered</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>

<script>
    // ApexCharts Configuration
    document.addEventListener('DOMContentLoaded', function() {
        
        // Common chart options
        const commonOptions = {
            chart: {
                type: 'pie',
                height: 280,
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800
                },
                dropShadow: {
                    enabled: true,
                    color: '#000',
                    top: 18,
                    left: 7,
                    blur: 10,
                    opacity: 0.2
                }
            },
            legend: {
                position: 'bottom',
                fontSize: '13px',
                fontFamily: 'Inter, sans-serif',
                markers: {
                    width: 20,
                    height: 14,
                    strokeWidth: 0,
                    strokeColor: '',
                    fillColors: undefined,
                    radius: 20,
                    customHTML: undefined,
                    onClick: undefined,
                    offsetX: 0,
                    offsetY: 0
                }
            },
            tooltip: {
                enabled: true,
                theme: 'dark',
                style: {
                    fontSize: '14px',
                    fontFamily: 'Inter, sans-serif'
                }
            },
            plotOptions: {
                pie: {
                    donut: {
                        size: '45%'
                    }
                }
            },
            dataLabels: {
                enabled: true,
                formatter: function (val) {
                    return val.toFixed(1) + "%"
                },
                style: {
                    fontSize: '12px',
                    fontFamily: 'Inter, sans-serif',
                    fontWeight: 'bold',
                    colors: ['#fff']
                },
                dropShadow: {
                    enabled: true
                }
            }
        };

        // Chart 1 - Sales Distribution
        const chart1Options = {
            ...commonOptions,
            series: [35, 25, 20],
            labels: ['Sales closed', 'UEOB', 'Collection'],
            colors: ['#28a745', '#20c997', '#17a2b8']
        };
        const chart1 = new ApexCharts(document.querySelector("#apexChart1"), chart1Options);
        chart1.render();

        // Chart 2 - User Demographics
        const chart2Options = {
            ...commonOptions,
            series: [30, 40, 20],
            labels: ['Sold', 'Sales Gap', 'Further'],
            colors: ['#007bff', '#6610f2', '#e83e8c']
        };
        const chart2 = new ApexCharts(document.querySelector("#apexChart2"), chart2Options);
        chart2.render();

        // Chart 3 - Leads chart (Bar Chart)
        const chart3Options = {
            chart: {
                type: 'bar',
                height: 300,
                width: '100%',
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800
                },
                dropShadow: {
                    enabled: true,
                    color: '#000',
                    top: 18,
                    left: 7,
                    blur: 10,
                    opacity: 0.2
                }
            },
            series: [{
                name: 'Leads',
                data: [45, 30, 15, 10, 17, 9]
            }],
            xaxis: {
                categories: ['Quotation', 'Project Closed', 'Lost', 'GRN', 'Negotiation', 'Dispatch'],
                labels: {
                    style: {
                        fontSize: '12px',
                        fontFamily: 'Inter, sans-serif'
                    }
                }
            },
            yaxis: {
                labels: {
                    style: {
                        fontSize: '12px',
                        fontFamily: 'Inter, sans-serif'
                    }
                }
            },
            colors: ['#28a745', '#ffc107', '#dc3545', '#6c757d', '#20c997', '#007bff'],
            plotOptions: {
                bar: {
                    distributed: true,
                    horizontal: false,
                    columnWidth: '80%',
                    borderRadius: 4
                }
            },
            dataLabels: {
                enabled: true,
                formatter: function (val) {
                    return val
                },
                style: {
                    fontSize: '12px',
                    fontFamily: 'Inter, sans-serif',
                    fontWeight: 'bold',
                    colors: ['#fff']
                }
            },
            legend: {
                show: false
            },
            tooltip: {
                enabled: true,
                theme: 'dark',
                style: {
                    fontSize: '14px',
                    fontFamily: 'Inter, sans-serif'
                }
            },
            grid: {
                padding: {
                    left: 10,
                    right: 10,
                    top: 10,
                    bottom: 10
                }
            }
        };
        const chart3 = new ApexCharts(document.querySelector("#apexChart3"), chart3Options);
        chart3.render();
    });
</script>

<style>
/* Scoped CSS for Leads chart (apexChart3) full-width rendering */
#apexChart3 {
    width: 100% !important;
}

#apexChart3 .apexcharts-canvas {
    width: 100% !important;
}

#apexChart3 .apexcharts-inner {
    width: 100% !important;
}

/* Ensure the chart wrapper for bar chart uses full width */
.chart-container:has(#apexChart3) .chart-wrapper {
    width: 100%;
    padding: 0;
    margin: 0;
}

/* Value Cards Container - Two cards side by side */
.value-cards-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    height: 100%;
}

.value-cards-container .small-card {
    flex: 1;
    min-height: 120px;
    display: flex;
    align-items: center;
}

.value-cards-container .small-card .card-body {
    padding: 1rem 0.75rem;
    height: 100%;
}

.value-cards-container .card-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #007bff, #0056b3);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
}

.value-cards-container .card-icon i {
    font-size: 1.1rem;
}

.value-cards-container .card-subtitle {
    font-size: 0.7rem;
    letter-spacing: 0.5px;
}

.value-cards-container .card-value {
    font-size: 1.4rem;
    color: #2c3e50;
    line-height: 1.2;
}

/* Responsive adjustments for value cards */
@media (max-width: 768px) {
    .value-cards-container {
        flex-direction: row;
        gap: 0.5rem;
    }
    
    .value-cards-container .card-value {
        font-size: 1.2rem;
    }
    
    .value-cards-container .card-subtitle {
        font-size: 0.65rem;
    }
}
</style>
{% endblock %}