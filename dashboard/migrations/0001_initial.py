# Generated by Django 6.0 on 2026-01-06 10:22

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Company',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=200, verbose_name='Company Name')),
                ('city', models.CharField(max_length=100, verbose_name='City')),
                ('address', models.TextField(verbose_name='Company Address')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Company',
                'verbose_name_plural': 'Companies',
                'ordering': ['company_name', 'city'],
                'unique_together': {('company_name', 'city')},
            },
        ),
        migrations.CreateModel(
            name='Contact',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='Phone Number')),
                ('location_city', models.CharField(blank=True, max_length=100, verbose_name='Location (City)')),
                ('individual_address', models.TextField(blank=True, null=True, verbose_name='Individual Address')),
                ('customer_name', models.CharField(blank=True, max_length=200, null=True, verbose_name='Customer Name')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email Address')),
                ('plant', models.CharField(blank=True, max_length=100, null=True, verbose_name='Plant Location')),
                ('address', models.TextField(blank=True, null=True, verbose_name='Address')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='dashboard.company', verbose_name='Company')),
            ],
            options={
                'verbose_name': 'Contact',
                'verbose_name_plural': 'Contacts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InquiryHandler',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('create_id', models.CharField(blank=True, help_text='Auto-generated ID (e.g., KEC020JY2025)', max_length=15, unique=True, verbose_name='Create ID')),
                ('status', models.CharField(choices=[('Inquiry', 'Inquiry'), ('Inputs', 'Inputs'), ('Inspection', 'Inspection'), ('Inquiry Hold', 'Inquiry Hold'), ('Pending', 'Pending'), ('Quotation', 'Quotation'), ('Negotiation', 'Negotiation'), ('PO-Confirm', 'PO-Confirm'), ('PO Hold', 'PO Hold'), ('Design', 'Design'), ('Design Review', 'Design Review'), ('Material Receive', 'Material Receive'), ('Manufacturing', 'Manufacturing'), ('Stage-Inspection', 'Stage-Inspection'), ('Approval', 'Approval'), ('Dispatch', 'Dispatch'), ('GRN', 'GRN'), ('Project Closed', 'Project Closed'), ('Lost', 'Lost')], default='Inputs', help_text='Select current status', max_length=20, verbose_name='Status')),
                ('opportunity_id', models.CharField(blank=True, help_text='Auto-generated based on status (e.g., eKEC020JY2025)', max_length=20, verbose_name='Opportunity ID')),
                ('lead_description', models.TextField(blank=True, default='', help_text='Enter lead description manually', verbose_name='Lead Description')),
                ('customer_name', models.CharField(blank=True, help_text='Auto-fetched based on company selection', max_length=200, verbose_name='Customer Name')),
                ('quote_no', models.CharField(blank=True, help_text='Same as Create ID (e.g., KEC020JY2025)', max_length=15, verbose_name='Quote Number')),
                ('date_of_quote', models.DateField(help_text='Enter quote date manually', verbose_name='Date of Quote')),
                ('remarks', models.TextField(blank=True, help_text='Enter remarks manually (optional)', null=True, verbose_name='Remarks')),
                ('next_date', models.DateField(blank=True, help_text='Enter next date manually (optional)', null=True, verbose_name='Next Date')),
                ('remarks_add', models.TextField(blank=True, help_text='Enter additional supply remarks manually (optional)', null=True, verbose_name='Additional Supply Remarks')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(help_text='Select company from database', on_delete=django.db.models.deletion.CASCADE, related_name='inquiries', to='dashboard.contact', verbose_name='Company')),
                ('sales', models.ForeignKey(blank=True, help_text='Select sales person from database', limit_choices_to={'userprofile__roles__contains': 'sales'}, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Sales Person')),
            ],
            options={
                'verbose_name': 'Inquiry Handler',
                'verbose_name_plural': 'Inquiry Handlers',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InquiryItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('item_name', models.CharField(help_text='Enter item name manually', max_length=200, verbose_name='Item Name')),
                ('quantity', models.DecimalField(decimal_places=2, help_text='Enter quantity', max_digits=10, verbose_name='Quantity')),
                ('price', models.DecimalField(decimal_places=2, help_text='Enter price per unit', max_digits=12, verbose_name='Price')),
                ('amount', models.DecimalField(decimal_places=2, editable=False, help_text='Auto-calculated: Quantity × Price', max_digits=15, verbose_name='Amount')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('inquiry', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='dashboard.inquiryhandler', verbose_name='Inquiry')),
            ],
            options={
                'verbose_name': 'Inquiry Item',
                'verbose_name_plural': 'Inquiry Items',
                'ordering': ['id'],
            },
        ),
        migrations.CreateModel(
            name='Invoice',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('invoice_number', models.CharField(blank=True, help_text='Auto-generated in format KEC/051/2526', max_length=50, unique=True, verbose_name='Invoice Number')),
                ('invoice_date', models.DateField(help_text='Enter invoice date manually', verbose_name='Invoice Date')),
                ('customer_name', models.CharField(blank=True, help_text='Auto-fetched based on client selection', max_length=200, verbose_name='Customer Name')),
                ('order_value', models.DecimalField(blank=True, decimal_places=2, help_text='Auto-fetched from selected purchase order', max_digits=12, null=True, verbose_name='Order Value')),
                ('grn_date', models.DateField(help_text='Enter GRN date manually', verbose_name='GRN Date')),
                ('payment_due_date', models.DateField(blank=True, help_text='Auto-calculated: GRN Date + Payment Terms from selected Purchase Order', null=True, verbose_name='Payment Due Date')),
                ('due_days', models.IntegerField(blank=True, help_text='Auto-calculated: days remaining (positive) or overdue (negative)', null=True, verbose_name='Due Days')),
                ('remarks', models.TextField(blank=True, help_text='Enter remarks manually (optional)', null=True, verbose_name='Remarks')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('sent', 'Sent'), ('invoiced', 'Invoiced'), ('paid', 'Paid'), ('partial', 'Partial'), ('overdue', 'Overdue'), ('cancelled', 'Cancelled')], default='draft', help_text='Current status of the invoice', max_length=20, verbose_name='Invoice Status')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(help_text='Select company from database', on_delete=django.db.models.deletion.CASCADE, related_name='invoices', to='dashboard.contact', verbose_name='Company')),
            ],
            options={
                'verbose_name': 'Invoice',
                'verbose_name_plural': 'Invoices',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AdditionalSupply',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('supply_date', models.DateField(help_text='Enter supply date manually', verbose_name='Supply Date')),
                ('description', models.TextField(help_text='Enter additional supply description', verbose_name='Additional Supply Description')),
                ('quantity', models.DecimalField(decimal_places=2, help_text='Enter quantity', max_digits=10, verbose_name='Quantity')),
                ('unit_price', models.DecimalField(decimal_places=2, help_text='Enter unit price', max_digits=12, verbose_name='Unit Price')),
                ('total_amount', models.DecimalField(decimal_places=2, editable=False, help_text='Auto-calculated: Quantity × Unit Price', max_digits=15, verbose_name='Total Amount')),
                ('remarks', models.TextField(blank=True, help_text='Enter remarks (optional)', null=True, verbose_name='Remarks')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('invoice', models.ForeignKey(help_text='Select invoice from database', on_delete=django.db.models.deletion.CASCADE, related_name='additional_supplies', to='dashboard.invoice', verbose_name='Invoice')),
            ],
            options={
                'verbose_name': 'Additional Supply',
                'verbose_name_plural': 'Additional Supplies',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notification_type', models.CharField(choices=[('additional_supply', 'Additional Supply Created'), ('purchase_order', 'Purchase Order Created'), ('invoice', 'Invoice Generated'), ('quotation', 'Quotation Generated')], max_length=20, verbose_name='Notification Type')),
                ('title', models.CharField(max_length=200, verbose_name='Notification Title')),
                ('message', models.TextField(verbose_name='Notification Message')),
                ('data', models.JSONField(default=dict, help_text='Additional data like PO number, company, customer', verbose_name='Notification Data')),
                ('is_read', models.BooleanField(default=False, verbose_name='Is Read')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(help_text='User who triggered this notification', on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
            ],
            options={
                'verbose_name': 'Notification',
                'verbose_name_plural': 'Notifications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PurchaseOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('po_number', models.CharField(max_length=50, verbose_name='PO Number')),
                ('order_date', models.DateField(verbose_name='Order Date')),
                ('customer_name', models.CharField(max_length=200, verbose_name='Customer Name')),
                ('order_value', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Order Value')),
                ('days_to_mfg', models.PositiveIntegerField(verbose_name='Days to Manufacturing')),
                ('delivery_date', models.DateField(blank=True, null=True, verbose_name='Delivery Date')),
                ('due_days', models.IntegerField(blank=True, help_text='Positive: days remaining, Negative: days overdue', null=True, verbose_name='Due Days')),
                ('remarks', models.TextField(blank=True, null=True, verbose_name='Remarks')),
                ('payment_terms', models.PositiveIntegerField(blank=True, help_text='Enter payment terms in days (e.g., 45 for 45 days)', null=True, verbose_name='Payment Terms (Days)')),
                ('sales_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='Enter percentage (e.g., 5.50 for 5.5%)', max_digits=5, null=True, verbose_name='Sales Percentage (%)')),
                ('project_manager_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='Enter percentage (e.g., 3.25 for 3.25%)', max_digits=5, null=True, verbose_name='Project Manager Percentage (%)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='purchase_orders', to='dashboard.contact', verbose_name='Company')),
                ('project_manager', models.ForeignKey(blank=True, limit_choices_to={'userprofile__roles__contains': 'project_manager'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_orders', to=settings.AUTH_USER_MODEL, verbose_name='Project Manager')),
                ('sales_person', models.ForeignKey(blank=True, limit_choices_to={'userprofile__roles__contains': 'sales'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='sales_orders', to=settings.AUTH_USER_MODEL, verbose_name='Sales Person')),
            ],
            options={
                'verbose_name': 'Purchase Order',
                'verbose_name_plural': 'Purchase Orders',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='invoice',
            name='purchase_order',
            field=models.ForeignKey(help_text='Select purchase order to auto-fetch value', on_delete=django.db.models.deletion.CASCADE, to='dashboard.purchaseorder', verbose_name='Purchase Order'),
        ),
        migrations.CreateModel(
            name='PurchaseOrderItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('material_code', models.CharField(blank=True, help_text='Item/Material code or SKU', max_length=100, null=True, verbose_name='Material Code')),
                ('item_name', models.CharField(help_text='Enter item name', max_length=200, verbose_name='Item Name')),
                ('quantity', models.DecimalField(decimal_places=2, help_text='Enter quantity', max_digits=10, verbose_name='Quantity')),
                ('price', models.DecimalField(decimal_places=2, help_text='Enter price per unit', max_digits=12, verbose_name='Price')),
                ('amount', models.DecimalField(decimal_places=2, editable=False, help_text='Auto-calculated: Quantity × Price', max_digits=15, verbose_name='Amount')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('purchase_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='dashboard.purchaseorder', verbose_name='Purchase Order')),
            ],
            options={
                'verbose_name': 'Purchase Order Item',
                'verbose_name_plural': 'Purchase Order Items',
                'ordering': ['id'],
            },
        ),
        migrations.CreateModel(
            name='Quotation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quote_number', models.CharField(max_length=50, unique=True)),
                ('revision', models.CharField(default='Rev A', max_length=20)),
                ('date_created', models.DateTimeField(auto_now_add=True)),
                ('quotation_date', models.CharField(max_length=100)),
                ('to_person', models.CharField(max_length=200)),
                ('firm', models.CharField(max_length=300)),
                ('address', models.TextField()),
                ('payment_terms', models.TextField()),
                ('delivery_terms', models.TextField()),
                ('scope_description', models.CharField(max_length=300)),
                ('scope_line_1', models.CharField(max_length=300)),
                ('scope_line_2', models.CharField(max_length=300)),
                ('fixtures_data', models.JSONField(default=list)),
                ('fixtures_count', models.IntegerField(default=0)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('generated', 'Generated'), ('sent', 'Sent'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='draft', max_length=20)),
                ('file_path', models.CharField(blank=True, max_length=500, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Quotation',
                'verbose_name_plural': 'Quotations',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DraftImage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fixture_index', models.IntegerField(help_text='Index of the fixture this image belongs to', verbose_name='Fixture Index')),
                ('image', models.ImageField(upload_to='draft_images/', verbose_name='Image File')),
                ('original_filename', models.CharField(max_length=255, verbose_name='Original Filename')),
                ('file_size', models.IntegerField(verbose_name='File Size (bytes)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('quotation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='draft_images', to='dashboard.quotation', verbose_name='Quotation')),
            ],
            options={
                'verbose_name': 'Draft Image',
                'verbose_name_plural': 'Draft Images',
                'ordering': ['fixture_index'],
            },
        ),
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('roles', models.TextField(default='sales', help_text='Comma-separated list of roles')),
                ('phone_number', models.CharField(blank=True, max_length=20, null=True, verbose_name='Phone Number')),
                ('can_access_invoice_generation', models.BooleanField(default=False, verbose_name='Invoice Generation')),
                ('can_access_inquiry_handler', models.BooleanField(default=False, verbose_name='Inquiry Handler')),
                ('can_access_quotation_generation', models.BooleanField(default=False, verbose_name='Quotation Generation')),
                ('can_access_additional_supply', models.BooleanField(default=False, verbose_name='Additional Supply')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'User Profile',
                'verbose_name_plural': 'User Profiles',
            },
        ),
    ]
